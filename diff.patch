From 9baef51095f800eacc676b8d377ca22a18112c45 Mon Sep 17 00:00:00 2001
From: Jagdeep Kalsi <jagdeep@MOB00114.local>
Date: Tue, 5 Aug 2014 12:23:53 +0100
Subject: [PATCH 1/3] Completed scenarios for verify list on embedded book
 option menu

---
 features/library.feature                   | 22 +++++++++++++++++-----
 features/pages/anonymous_library_page.rb   | 16 +++++++++++++++-
 features/step_definitions/library_steps.rb | 14 +++++++++++---
 3 files changed, 43 insertions(+), 9 deletions(-)

diff --git a/features/library.feature b/features/library.feature
index f89cbcd..719107e 100644
--- a/features/library.feature
+++ b/features/library.feature
@@ -1,12 +1,24 @@
 Feature: Navigating the user library screen
 
-  Background:
+  @smoke @signed_in
+  Scenario: I am able to validate the shop link
     Given the anonymous library screen is displayed
     When I sign in
     Then I should be on the user library screen
-
-
-  @smoke
-  Scenario: I am able to validate the shop link
     Given I touch the shop icon
     Then I should see the shop page
+
+  @smoke @anonymous
+  Scenario Outline: Verify the menu option from the embedded books
+    Given the anonymous library screen is displayed
+    And I click on first embedded book options
+    Then I should see the following <OptionMenu>
+
+  Examples:
+    | OptionMenu                       |
+    | "Buy the full book"              |
+    | "About this book"                |
+    | "See table of contents"          |
+    | "Read sample"                    |
+    | "Mark sample as ‘Finished'"      |
+    | "Remove sample from your device" |
diff --git a/features/pages/anonymous_library_page.rb b/features/pages/anonymous_library_page.rb
index f9de8c8..a7c08c2 100644
--- a/features/pages/anonymous_library_page.rb
+++ b/features/pages/anonymous_library_page.rb
@@ -5,7 +5,10 @@ module PageObjectModel
     element :signin_button, "TextView marked:'Sign in'"
     element :shop_button, "* id:'button_shop'"
     element :your_library_label, "* marked:'Your library'"
-    element :book_cover_first, "BookCover index:0"
+    element :book_cover_first, 'BookCover index:0'
+    # TODO: Be aware multiple element has the same id
+    element :embedded_option_button, "* id:'btn_options'"
+    element :embedded_option_menu, "* id:'text1'"
 
     def open_first_book
       book_cover_first.touch
@@ -25,6 +28,17 @@ module PageObjectModel
       signin_button.touch
     end
 
+    def open_embedded_option_button
+      embedded_option_button.touch
+      embedded_option_button.wait_for_element_does_not_exist(timeout: 5)
+      embedded_option_menu.wait_for_element_exists(timeout: 5)
+    end
+
+    def option_exists?(option_name)
+      option_menu_item = Element.new("* marked:'#{option_name}'")
+      option_menu_item.exists?
+    end
+
     def logged_out?
       !your_library_label.exists?
     end
diff --git a/features/step_definitions/library_steps.rb b/features/step_definitions/library_steps.rb
index e9fe4bf..7494f74 100644
--- a/features/step_definitions/library_steps.rb
+++ b/features/step_definitions/library_steps.rb
@@ -1,8 +1,16 @@
 Given(/^I touch the shop icon$/) do
-	user_library_page.goto_shop
+  user_library_page.goto_shop
 end
 
 Then(/^I should see the shop page$/) do
-	shop_page.await
-	expect(shop_page).to be_displayed
+  shop_page.await
+  expect(shop_page).to be_displayed
+end
+
+And(/^I click on first embedded book options$/) do
+  anonymous_library_page.open_embedded_option_button
+end
+
+Then(/^I should see the following "(.*?)"$/) do |opt|
+  anonymous_library_page.option_exists?(opt)
 end
-- 
1.8.5.1


From cb4527262b6ca3c1c1b665579d3a9002ecf4a95f Mon Sep 17 00:00:00 2001
From: Jagdeep Kalsi <jagdeep@MOB00114.local>
Date: Tue, 5 Aug 2014 16:35:03 +0100
Subject: [PATCH 2/3] Update the code based on Alex comments

---
 features/library.feature                   | 5 +++--
 features/step_definitions/library_steps.rb | 5 -----
 2 files changed, 3 insertions(+), 7 deletions(-)

diff --git a/features/library.feature b/features/library.feature
index 719107e..ce699cc 100644
--- a/features/library.feature
+++ b/features/library.feature
@@ -1,12 +1,13 @@
 Feature: Navigating the user library screen
 
   @smoke @signed_in
-  Scenario: I am able to validate the shop link
+  Scenario: User navigates to the Shop from Library
     Given the anonymous library screen is displayed
     When I sign in
     Then I should be on the user library screen
     Given I touch the shop icon
-    Then I should see the shop page
+    Then the Shop page should be displayed
+
 
   @smoke @anonymous
   Scenario Outline: Verify the menu option from the embedded books
diff --git a/features/step_definitions/library_steps.rb b/features/step_definitions/library_steps.rb
index 7494f74..70bef1b 100644
--- a/features/step_definitions/library_steps.rb
+++ b/features/step_definitions/library_steps.rb
@@ -2,11 +2,6 @@ Given(/^I touch the shop icon$/) do
   user_library_page.goto_shop
 end
 
-Then(/^I should see the shop page$/) do
-  shop_page.await
-  expect(shop_page).to be_displayed
-end
-
 And(/^I click on first embedded book options$/) do
   anonymous_library_page.open_embedded_option_button
 end
-- 
1.8.5.1


From 6dac499acf34586784e2d8153b992919e743e152 Mon Sep 17 00:00:00 2001
From: Jagdeep Kalsi <jagdeep@MOB00114.local>
Date: Fri, 8 Aug 2014 16:38:35 +0100
Subject: [PATCH 3/3] Removed examples from the scenarios

---
 features/library.feature | 31 +++++++++++++++++--------------
 1 file changed, 17 insertions(+), 14 deletions(-)

diff --git a/features/library.feature b/features/library.feature
index ce699cc..7dddaba 100644
--- a/features/library.feature
+++ b/features/library.feature
@@ -8,18 +8,21 @@ Feature: Navigating the user library screen
     Given I touch the shop icon
     Then the Shop page should be displayed
 
+  @smoke
+  Scenario: I am able to validate the shop link
+    Given I touch the shop icon
+    Then I should see the shop page
 
-  @smoke @anonymous
-  Scenario Outline: Verify the menu option from the embedded books
-    Given the anonymous library screen is displayed
-    And I click on first embedded book options
-    Then I should see the following <OptionMenu>
-
-  Examples:
-    | OptionMenu                       |
-    | "Buy the full book"              |
-    | "About this book"                |
-    | "See table of contents"          |
-    | "Read sample"                    |
-    | "Mark sample as ‘Finished'"      |
-    | "Remove sample from your device" |
+   @smoke
+   Scenario: Verify option menu from 'Book to read' section
+     Given I sign in
+     And default view is device
+     When I scroll down to 'Book to read' section
+     And I click on option button
+     Then I should see the following <OptionMenu>
+      | "OptionMenu" |
+      | "About this book" |
+      | "See table of content" |
+      | "Read book" |
+      | "Mark as 'Finished'" |
+      | "Remove book from your device" |
-- 
1.8.5.1
